%h1 Current Search
= form_tag searches_save_topic_path do
  %table
    %thead
      %tr
      %th Search Term
      %th From
      %th To
      %th Number of Associated Tweets
    %tbody
    -#this will probably be problematic with multiple users but for now it's aight
    - if !@current_user.current_search.nil?
      %tr
        %td= @curr_view_search.search_term
        %td= @curr_view_search.from_date
        %td= @curr_view_search.to_date
        %td= @curr_view_search.number_of_tweets
  %br
  #graph{:style => "width:600px;height:250px;"}

  =submit_tag 'Save Topic', :method => :save_topic

  = content_tag 'div', '', id: 'data', data: {key1: @graph_data }


:javascript
    //Grab the graph div and the data from the data div
    graph = document.getElementById('graph');
    data = $('#data').data('key1');

    //Create an array for the x and y values
    var dates = new Array();
    var y_vals = new Array();

    //Array of all traces
    var data_arr = new Array();

    //Iterate over the JSON and push the elements into appropriate arrays
    var i;
    for (i = 0; i < data.length; i++){
      dates.push(data[i]['date']);
      y_vals.push(data[i]['value']);
    }

    //Place the data into a trace
    var trace = {
    x: dates,
    y: y_vals,
    mode: 'lines+markers'};


     data_arr.push(trace);

    Plotly.plot(graph, data_arr);


